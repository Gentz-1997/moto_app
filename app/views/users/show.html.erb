<% provide(:title, "マイページ") %>
<div class="flex flex-col items-center py-12 w-full max-w-3xl mx-auto">
  <h1 class="font-bold text-2xl text-gray-700 mb-8">マイページ</h1>
  <div class="flex items-center space-x-4 mb-8">
    <div class="flex-shrink-0">
      <%= render 'shared/avatar', user: @user %>
    </div>
    <div class="flex-1 text-gray-700 mx-2">
      <p class="text-base truncate">
        <%= current_user.name %>
      </p>
    </div>
    <%= link_to "編集", edit_user_registration_path(current_user), class: "w-10 bg-blue-sky text-white py-2 px-4 rounded hover:bg-sky-600 transition duration-200" %>
  </div>
  <div class="w-full max-w-2xl mx-auto">
  <!-- タブボタン -->
  <div class="flex justify-center space-x-4 mb-4 border-b">
    <button class="tab-button py-2 px-4 font-semibold text-gray-600 border-b-2 border-transparent hover:border-blue-500 hover:text-blue-500" onclick="openTab(event, 'spots')">登録したスポット</button>
    <button class="tab-button py-2 px-4 font-semibold text-gray-600 border-b-2 border-transparent hover:border-blue-500 hover:text-blue-500" onclick="openTab(event, 'posts')">投稿一覧</button>
    <button class="tab-button py-2 px-4 font-semibold text-gray-600 border-b-2 border-transparent hover:border-blue-500 hover:text-blue-500" onclick="openTab(event, 'favorites')">お気に入りスポット</button>
  </div>

  <!-- タブの内容 -->
  <div id="spots" class="tab-content">
    <h2 class="text-xl font-semibold mb-4">登録したスポット</h2>
    <%= render 'shared/spot' %>
  </div>

  <div id="posts" class="tab-content hidden">
    <h2 class="text-xl font-semibold mb-4">投稿一覧</h2>
    <% @user.posts.each do |post| %>
      <%= render 'shared/post', post: post, show_spot_info: true %>
    <% end %>
  </div>

  <div id="favorites" class="tab-content hidden">
    <h2 class="text-xl font-semibold mb-4">お気に入りスポット</h2>
    <% @favorite_spots.each do |favorite_spot| %>
      <%= link_to favorite_spot.spot_name, spot_path(favorite_spot), class: "text-blue-500 hover:underline" %>
      <%= favorite_spot.address %>
    <% end %>
  </div>
</div>

<script type="module">
  import { openTab } from "tabs";
  window.openTab = openTab; // グローバル関数として設定
</script>
</div>